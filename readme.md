# 算法设计
并行机(parallel machine)调度问题为将$n$个作业分配到$m$台机器上, 作业$j$在机器$i$上的加工时间为$p_{ji}$, 决策变量$y_{ji} \in \{0,1\}$表示作业$j$是否在机器$i$上加工, 目标是最小化最大完工时间$C_{max}$. 具体的MIP模型如下:
$$
\min  C_{\max}
\\
s.t. \sum_{i\in \mathcal{M}}{y_{ji}}=1 \forall j\in \mathcal{J}
\\
\,\,     C_{\max}\ge \sum_{j\in \mathcal{J}}{p_{ji}y_{ji}}\,\,\forall i\in \mathcal{M}
\\
\,\,    y_{ji}\in \left\{ 0,1 \right\} \,\,\forall j\in \mathcal{J} ,\forall i\in \mathcal{M}
$$
本文以OPTV为内核求解器，分别设计了构造启发式算法greedy lp round(glr)和基于邻域搜索的局部搜索算法local search(ls). 并通过实验比较了两种算法的性能.
## greedy lp round(glr)
glr以MIP的线性松弛解$\tilde{y}$为起点, 将$\alpha$个作业分配到机器上. 具体步骤如下: 首先求解MIP的线性松弛问题, 得到线性松弛解$\tilde{y}$. 然后遍历每个作业, 对于作业$j$, 找到$\tilde{y}_{jk_j}=\max_{k\in \mathcal{M}} \tilde{y}_{jk}$,
然后将最大的前$\alpha$个$\tilde{y}_{jk_j}$做如下操作: 将原始MIP模型中的决策变量$y_{jk_j}$固定为1, 然后使用OPTV求解器求解缩减后的MIP模型, 得到初始的整数可行解$\bar{y}$.
## local search
ls以glr获得的初始解$\bar{y}$为起点, 每次迭代通过添加约束或者固定决策变量, 缩减问题规模, 使模型更容易求解. 本文设计了两种邻域, 分别为local branching邻域和random fix邻域. local branching邻域通过添加local branching约束限制模型中01决策变量翻转的总次数, local branching约束如下:
$$
\sum_{j\in \mathcal{J} ,i\in \mathcal{M} :\bar{y}_{ji}=0}{y_{ji}}+\sum_{j\in \mathcal{J} ,i\in \mathcal{M} :\bar{y}_{ji}=1}{\left( 1-y_{ji} \right)}\le \beta
$$
random fix邻域的构造过程如下: 首先确定被destroy的工件个数$\gamma$, 然后不断迭代, 每次迭代时找到最大负载的机器, 然后从中随机选择一个工件加入destroy集合, 更新该机器负载, 直到destroy集合中的工件个数等于$\gamma$. 下一步将MIP模型中不在destroy集合中的工件固定到当前最好解对应的机器上, 从而构造出缩减的MIP问题, 然后求解.
为了避免算法陷入循环, 在local search阶段交替使用local branching和random fix邻域. 主要使用local branching邻域, 当进行邻域搜索后如果找不到更好的解, 则切换到random fix邻域, 直到找到更好的解, 此时再切换到local branching邻域.
# 数值实验
实验环境为Ubuntu 22.04.4 LTS操作系统, Intel(R) Xeon(R) Gold 6248R CPU @ 3.00GHz CPU, 1.0T RAM. 内核求解器为OptVerse Optimizer version 1.5.2. 数据集来源为Parallel Machine Scheduling标准数据集, 论文为"Mixed-Integer Programming Versus Constraint Programming for Shop Scheduling Problems: New Results and Outlook".
根据论文中的结果, 选择100个Gurobi求解3600s未证明最优的算例, 视为难例. 然后进一步筛选, 使用OPTV求解这些难例子, 限定求解时间为300s, 线程数为1. 最终有91个算例没有求到最优. 针对这91个算例, 使用lns算法求解, 限定求解时间为300s, 线程数为1. 有40个算例lns在300s时上界更小, 23个算例OPTV在300s时上界更小, 28个算例二者相等.
具体实验结果如下(Best_obj为二者取最小):
|   Instance |   Best_Obj |   Base_Obj |    Gap_Base |   LNS_Obj |    Gap_LNS |
|-----------:|-----------:|-----------:|------------:|----------:|-----------:|
|       1012 |        257 |        257 | 0           |       257 | 0          |
|       1013 |        272 |        272 | 0           |       272 | 0          |
|       1015 |        286 |        286 | 0           |       286 | 0          |
|       1016 |        264 |        264 | 0           |       265 | 0.00378788 |
|       1017 |        273 |        273 | 0           |       273 | 0          |
|       1018 |        286 |        287 | 0.0034965   |       286 | 0          |
|       1019 |        272 |        272 | 0           |       273 | 0.00367647 |
|       1020 |        234 |        235 | 0.0042735   |       234 | 0          |
|       1021 |        177 |        178 | 0.00564972  |       177 | 0          |
|       1022 |        174 |        174 | 0           |       174 | 0          |
|       1023 |        182 |        182 | 0           |       184 | 0.010989   |
|       1024 |        174 |        174 | 0           |       174 | 0          |
|       1025 |        171 |        171 | 0           |       171 | 0          |
|       1026 |        163 |        165 | 0.0122699   |       163 | 0          |
|       1027 |        173 |        174 | 0.00578035  |       173 | 0          |
|       1028 |        169 |        169 | 0           |       170 | 0.00591716 |
|       1029 |        186 |        187 | 0.00537634  |       186 | 0          |
|       1030 |        181 |        181 | 0           |       181 | 0          |
|       1075 |        319 |        319 | 0           |       321 | 0.00626959 |
|       1094 |        214 |        214 | 0           |       214 | 0          |
|        339 |       1300 |       1301 | 0.000769231 |      1300 | 0          |
|        535 |       1316 |       1316 | 0           |      1316 | 0          |
|        975 |      34058 |      34081 | 0.000675319 |     34058 | 0          |
|       1031 |        143 |        145 | 0.013986    |       143 | 0          |
|       1032 |        130 |        131 | 0.00769231  |       130 | 0          |
|       1033 |        150 |        152 | 0.0133333   |       150 | 0          |
|       1034 |        139 |        140 | 0.00719424  |       139 | 0          |
|       1035 |        139 |        141 | 0.0143885   |       139 | 0          |
|       1037 |        123 |        125 | 0.0162602   |       123 | 0          |
|       1038 |        138 |        138 | 0           |       138 | 0          |
|       1039 |        125 |        125 | 0           |       125 | 0          |
|       1040 |        133 |        133 | 0           |       134 | 0.0075188  |
|       1045 |        101 |        101 | 0           |       102 | 0.00990099 |
|       1046 |        114 |        114 | 0           |       116 | 0.0175439  |
|       1049 |        106 |        106 | 0           |       107 | 0.00943396 |
|       1071 |        354 |        354 | 0           |       355 | 0.00282486 |
|       1072 |        357 |        358 | 0.00280112  |       357 | 0          |
|       1073 |        337 |        337 | 0           |       339 | 0.00593472 |
|       1074 |        356 |        357 | 0.00280899  |       356 | 0          |
|       1076 |        349 |        349 | 0           |       350 | 0.00286533 |
|       1077 |        359 |        359 | 0           |       361 | 0.00557103 |
|       1078 |        358 |        358 | 0           |       359 | 0.0027933  |
|       1079 |        347 |        348 | 0.00288184  |       347 | 0          |
|       1080 |        343 |        343 | 0           |       343 | 0          |
|       1081 |        251 |        251 | 0           |       252 | 0.00398406 |
|       1082 |        263 |        263 | 0           |       264 | 0.00380228 |
|       1083 |        259 |        259 | 0           |       259 | 0          |
|       1084 |        267 |        268 | 0.00374532  |       267 | 0          |
|       1085 |        265 |        265 | 0           |       265 | 0          |
|       1086 |        266 |        266 | 0           |       266 | 0          |
|       1087 |        269 |        271 | 0.00743494  |       269 | 0          |
|       1088 |        247 |        248 | 0.00404858  |       247 | 0          |
|       1089 |        258 |        259 | 0.00387597  |       258 | 0          |
|       1090 |        241 |        241 | 0           |       241 | 0          |
|       1091 |        225 |        226 | 0.00444444  |       225 | 0          |
|       1092 |        214 |        214 | 0           |       215 | 0.0046729  |
|       1093 |        218 |        219 | 0.00458716  |       218 | 0          |
|       1095 |        203 |        203 | 0           |       205 | 0.00985222 |
|       1096 |        194 |        194 | 0           |       196 | 0.0103093  |
|       1097 |        225 |        226 | 0.00444444  |       225 | 0          |
|       1098 |        207 |        209 | 0.00966184  |       207 | 0          |
|       1099 |        205 |        205 | 0           |       206 | 0.00487805 |
|       1100 |        223 |        223 | 0           |       224 | 0.0044843  |
|        126 |         64 |         64 | 0           |        64 | 0          |
|        127 |         62 |         62 | 0           |        62 | 0          |
|        671 |         87 |         88 | 0.0114943   |        87 | 0          |
|        673 |         87 |         87 | 0           |        87 | 0          |
|        674 |         89 |         90 | 0.011236    |        89 | 0          |
|        675 |         90 |         91 | 0.0111111   |        90 | 0          |
|        676 |         87 |         88 | 0.0114943   |        87 | 0          |
|        677 |         87 |         87 | 0           |        87 | 0          |
|        679 |         87 |         88 | 0.0114943   |        87 | 0          |
|        689 |         65 |         65 | 0           |        65 | 0          |
|        722 |        209 |        209 | 0           |       210 | 0.00478469 |
|        730 |        211 |        212 | 0.00473934  |       211 | 0          |
|        731 |        149 |        150 | 0.00671141  |       149 | 0          |
|        736 |        150 |        150 | 0           |       150 | 0          |
|        737 |        153 |        153 | 0           |       153 | 0          |
|        738 |        153 |        154 | 0.00653595  |       153 | 0          |
|        739 |        148 |        150 | 0.0135135   |       148 | 0          |
|        741 |        117 |        117 | 0           |       117 | 0          |
|        743 |        118 |        118 | 0           |       118 | 0          |
|        744 |        118 |        119 | 0.00847458  |       118 | 0          |
|        745 |        117 |        118 | 0.00854701  |       117 | 0          |
|        747 |        118 |        119 | 0.00847458  |       118 | 0          |
|        749 |        116 |        116 | 0           |       117 | 0.00862069 |
|        750 |        115 |        116 | 0.00869565  |       115 | 0          |
|        791 |        228 |        228 | 0           |       228 | 0          |
|        793 |        230 |        232 | 0.00869565  |       230 | 0          |
|        795 |        230 |        232 | 0.00869565  |       230 | 0          |
|        798 |        231 |        231 | 0           |       231 | 0          |
|        Avg |            |            | 0.0033164   |           | 0.0016529  |
